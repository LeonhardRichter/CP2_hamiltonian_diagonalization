% Contains an abstract (half a page), a short description of the background of the field and on the simulation method, a detailed description what is planned in the project, a timetable until when the code is expected to be completed and when results are expected

\begin{abstract}
    This report demonstrates the application of the \emph{Lanczos algorithm} for approximating a hermitian matrix by a lower-dimensional tri-diagonal one.
    Given a tri-diagonal approximation on a low-dimensional subspace, standard methods for fully diagonalizing or computing matrix functions such as the exponential become feasible and usually give approximations for the corresponding objects of the original matrix.
    This method is especially efficient when applied to sparse matrices as typically arise in spin Hamiltonians.  
    Here, we consider a system of many non-interacting two-level systems that couple equally to a harmonic oscillator---the Dicke model.
    The Dicke model features a so-called \emph{super-radiant phase}, where there are states that spontaneously emit more photons than expected.
    This phenomenon is typically described by a transition amplitude of spontaneous emission scaling up to quadratically with the number of two-level systems.
    Here, we apply Lanczos algorithm in order to simulate dynamical properties of the Dicke model.
    In particular, the expectation value for the number of photons depending on time is compared for different initial states and different coupling strengths.
    Prior to its application to this problem, the algorithm itself is being discussed in detail and is implemented in the programming language \texttt{python}.
\end{abstract}

\section{The Lanczos algorithm}
% The time evolution for a duration \(t\in\R\) of a quantum system modeled by a time-independent self-adjoint operator \(H\), the \emph{Hamiltonian}, acting on some Hilbert space \(\HH\) is given by the unitary operator\footnotemark \(U(t) = e^{-\iu t H}\).
% \footnotetext{Here, and in the following we work in \carefull{natural units} where \(\hbar = 1\).}

The Lanczos method is a numerical method to approximate spectral properties of hermitian matrices. 
Given such a matrix \(H \in \C^{N\times N}\), the method provides iteratively a \(d\)-dimensional approximation of \(H\) that is tri-diagonal after \(d-1\) iterations and which can easily be diagonalized in \(\mathcal{O}(N)\) time.
The only necessary information specific to \(H\) is an oracle for the matrix-vector product \(H\cdot v\).
If the matrix is sparse, i.e. if the ratio of the number of non-zero and zero entries is constant in \(N\) and small, the matrix-vector product can be evaluated in \(\mathcal{O}(N)\) time and storing such matrices takes \(\mathcal{O}(N)\) memory \cite{kocherikLanczosMethod2015}. 
Due to fast convergence of the method with respect to a growing number of iterations, approximating the lowest eigenvalue takes \(\mathcal{O}(1)\) iterations and therefore \(\mathcal{O}(N)\) memory and time \cite{kocherikLanczosMethod2015}.
In addition, eigenvectors and the matrix-exponential may also be approximated using this method. 

The idea of the Lanczos algorithm is to find an orthonormal basis \(\Set{v_i}_{0\leq i \leq K}\) for the \emph{Krylov space}
\begin{equation}
    \mathcal{K}^{(K)}_H(v) = \vecspan\of*{\Set{v, Hv, H^2v, H^3v, \dots, H^K v}}
\end{equation}
of order \(K \leq N-1\) such that \((\innerp{v_i}{H v_j})_{0 \leq i,j \leq K}\) is a tri-diagonal matrix. 
Then when extending this basis to a basis \((\tilde v_i)_{0\leq i \leq N}\) of \(C^N\), the non-trivial part of the projection 
\begin{equation}
    P_{K+1} H P_{K+1} = \tilde H_{\mathcal{K}^{(K)}_H(v)} \oplus 0_{(\mathcal{K}^{(K)}_H(v))^\perp}, \quad P_n v \coloneq \sum_{i=1}^n \innerp{v_i}{v} v_i
\end{equation}
onto the first \(K+1\) basis elements of \((\tilde{v}_i)_{0\leq i \leq N}\) is tri-diagonal. 
This projection is known as the \emph{Galerkin approximation} of \(H\) and in the finite-dimensional case converges trivially to \(H\) when \(K \to N-1\).

The algorithm computes this orthonormal basis for \(\mathcal{K}^{(K)}_H(v)\) is computed very similar to \emph{Gram-Schmidt orthogonalization} but of an iteratively defined set of vectors. 
Set \(v_0 = v / \norm{v}\), for some arbitrary vector \(v\in\C^N\). 
The next vector \(v_1\) is the normalized Gram-Schmidt orthogonalization of \(H v_0\) with respect to \(v_0\):
\begin{equation}
    b_1 v_1 = \tilde v_1 = H v_0 - \innerp{v_0}{H v_0} v_0
    ,
\end{equation}
where we introduced the notation \(b_n = \norm{\tilde v_n}\).
In general, \(v_{n+1}\) is defined as 
\begin{equation}
    b_{n+1} v_{n+1} = \tilde v_{n+1} = H v_n - \sum_{i=0}^n \innerp{v_i}{H v_i} v_i
    .
\end{equation}
With this definition the desired property of \((\innerp{v_i}{H v_j})_{0 \leq i,j \leq K}\) follows due to \(H\) being hermitian.

\begin{lemma}\label{thm:lanczos-ONB}
    Let \(H\in \C^{N\times N}\) for \(N\in\N\) be a hermitian matrix, \(v_0 = v / \norm{v}\), and \(K \leq N-1\).
    Define \(v_n\) recursively for \(1 \leq n \leq K\) by
    \begin{equation}\label{eq:lanczos-basis-def}
        b_{n+1}v_{n+1} = \tilde v_{n+1} = H v_n - \sum_{i=0}^n \innerp{v_i}{H v_n} v_i
        ,
    \end{equation}
    with \(b_n = \norm{\tilde v_n}\).
    Then
    \begin{equation}\label{eq:lanczos-basis}
        b_{n+1} v_{n+1} = H v_n - a_n v_n - b_n v_{n-1}
    \end{equation}
    for \(n\leq K\) with \(a_n = \innerp{v_n}{H v_n}\) and \(v_{-1} = 0\),
    the set \((v_n)_{0\leq n \leq K}\) is a orthonormal basis for \(\mathcal{K}^{(K)}_H(v)\), and its matrix representation
    \begin{equation}\label{eq:lanczos-tri-diagonal}
        (\innerp{v_i}{H v_j})_{0 \leq i,j \leq K} = 
        \begin{pmatrix}
            a_0 & b_1 &        &        &         &    \\
            b_1 & a_1 & b_2    &        &   0     &    \\
                & b_2 & a_3    & \ddots &         &    \\
                &     & \ddots & \ddots & \ddots  &    \\
                & 0   &        & \ddots & a_{K-1} & b_K\\
                &     &        &        & b_K     & a_{K}
        \end{pmatrix}
    \end{equation}
    is tri-diagonal.
\end{lemma}
\begin{proof}
    The proof can be found in the appendix.
\end{proof}

The Lanczos algorithm consists of computing the basis \(\Set{v_n}\) according to \cref{eq:lanczos-basis} iteratively. 
Per iteration one matrix-vector product needs to be computed, which is the computationally most expensive operation.

\section{The Dicke Model}
In this report we consider the application of Lanczos algorithm to the \emph{Dicke model}.
It models the collective interaction of a collection of \(N\in\N\) identical two-level systems (e.g. spins) with a harmonic oscillator (e.g. a single mode of some bosonic field).
It can be seen as a multi-particle generalization of the celebrated quantum Rabi-model \cite{rabiSpaceQuantizationGyrating1937} and was introduced by \textcite{dickeCoherenceSpontaneousRadiation1954} in order to describe the spontaneous emission by a collection of molecules modelled as two-level systems.
In his work, \citeauthor{dickeCoherenceSpontaneousRadiation1954} found that for certain states his model predicts unusual high emission rates---an effect known as \emph{super-radiance}.
This result was confirmed later by \textcite{heppSuperradiantPhaseTransition1973}, who proved the existence of a phase transition to a region where super-radiant states exist in the thermodynamic limit of \(N\to\infty\).

The goal for this project is to investigate the super-radiance phenomenon numerically for large \(N\).
The full Dicke Hamiltonian on \((\C^2)^{\otimes N} \otimes \Ltwo{\R}\) is given by
\begin{equation}\label{eq:dicke-hamiltonian}
    H_{\mathrm{D}} = \frac{\Omega}{2} \SZ \otimes \one + \omega \one \otimes \nn + \lambda \SX \otimes \of*{\an + \ad}
    ,
\end{equation}
where \(\Omega\) is the energy gap of the two-level systems, \(\omega\) is the frequency of the bosonic mode.
\carefull{In the following we will only consider the fully resonant case \(\Omega=\omega\).}
The creation and annihilation operators, \(\ad\) and \(\an\) are defined as usual by acting on an orthonormal basis \(\phi_n\) of \(\Ltwo{\R}\) via \(\ad\phi_n = \sqrt{n+1} \phi_{n+1}\) and \(\an\phi_n = \sqrt{n}\phi_{n-1}\).
The number operator with \(\nn \phi_n = n \phi_n\) is defined accordingly.
The collective spin operators 
\begin{gather}
	\s{}_{a} = \sum_{i = 1}^n \pauliI{a}{i}, \quad \pauliI{a}{i} = \one^{\otimes i-1}\otimes \pauli{a}\otimes \one^{\otimes N-i}
    ,
\end{gather}
with \(a \in \cof{x,y,z}\) act collectively with the corresponding single spin Pauli matrices \(\pauli{x},\pauli{y},\pauli{z}\) and satisfy the commutation relations of the angular-momentum-algebra:
\begin{equation}\label{eq:angular-momentum-algebra}
	\comm{\s{}_k}{\s{}_l} = i2\tensor{\epsilon}{_{k,l}^{m}}\s{}_m
    .
\end{equation}
Thus they give a representation of \(\mathfrak{so}(3)\) and there is a basis \(\ket{j,m}\) of \((\C^2)^{\otimes N}\) with eigenvalues
\begin{gather}
	\label{eq:dicke-states-total-spin}
	(\SX^2 + \SY^2 + \SZ^2)\ket{j,m} = j(j+1)\ket{j,m}
	\\
	\label{eq:dicke-states-magnetic-number}
	\s{}_z\ket{j,m} = m\ket{j,m}
	\\
	\label{eq:dicke-states-orthonormal}
	\innerp{j,m}{j\primed,m\primed} = \delta_{j,j\primed}\delta_{m,m\primed}
\end{gather}
with \(j = 0,1,\dots, \nicefrac{N}{2}\) and \(m = -j,-j+1, \dots,j-1, j\).
In this context, these states are commonly known as \emph{Dicke states}.
The Hamiltonian \(H_D\) commutes with the total collective spin operator \(\SX^2 + \SY^2 + \SZ^2\) and thus its matrix elements offer a block diagonal structure with blocks for each value of \(j\).

For these states, the transition probability for spontaneous emission is \cite[Ch. 5]{larsonJaynesCummingsModelIts2021}
\begin{equation}
    \mathcal P(j,m) = \sum_{\psi} \abs*{\innerp[\big]{\psi}{\s-\otimes\ad \ket{j,m}\otimes  \phi_0}}^2
    = (j+m)(j-m+1)
    .
\end{equation}
For a state where all two-level systems are in the excited state, \(\ket{\nicefrac{N}{2}, \nicefrac{N}{2}} = \ket{1,\dots, 1}\), this is proportional to the number of two-level systems: \(\mathcal P(\nicefrac{N}{2}, \nicefrac{N}{2}) \propto N \), as might be expected by classical intuition.
However, there is a so called superradiant state \(\ket{\nicefrac{N}{2}, 0}\), which exceeds this scaling: \(\mathcal P(\nicefrac{N}{2}, 0) \propto N^2 \) \cite{larsonJaynesCummingsModelIts2021}.
This super linear scaling with the number of systems is called \emph{super radiance} \cite{dickeCoherenceSpontaneousRadiation1954}.

\section{Description of the project}\label{ch:project-description}
In this project the super radiance effect shall be demonstrated by numerical simulation of the dynamical behaviour of the expectation value \(\innerp{\psi(t)}{\one\otimes\nn \psi(t)}\) of the number of photons in the system will be analysed.
For this purpose, the Lanczos algorithm is applied to the matrix 
\begin{equation}
    M_D = \of[\Bigg]{ \innerp[\big]{\ket{j,m}\otimes\phi_n}{H_D \ket{j\primed,m\primed}\otimes\phi_{n\primed}} }_{\substack{
        0\leq j,j\primed \leq \nicefrac{N}{2}
        \\
        -j \leq m,m\primed \leq j
        \\
        0 \leq n, n\primed \leq n_{\mathrm{max}}
    }}
\end{equation}
with respect to some initial state \(\psi_0\) in order to obtain an approximation \(\tilde M_D^{(K)}\), where \(n_{\mathrm{max}}\) is some cut-off for the number of photons.
This matrix represents the operator \(H_D\) restricted to the space of up to \(n_{\mathrm{max}}\) photons: \((\C^2)^{\otimes N} \otimes \vecspan\Set{\phi_n \given n\leq n_{\mathrm{max}}}\).
For reasonably small \(K\), the matrix exponential \(\exp\of{-\iu \delta \tilde M_D^{(K)}}\) can then be easily calculated for small times \(\delta\) by standard methods.
Here, the plan is to use \texttt{scipy.linalg.expm}.
This procedure can be iterated by repeatedly applying Lanczos algorithm to approximate \(M_D\) with respect to \(\psi_1 = \exp\of{-\iu \delta M_D} \psi_0\), \(\psi_2 = \exp\of{-\iu \delta M_D}^2 \psi_0\), \dots, \(\psi_{\lfloor T / \delta \rfloor} = \exp\of{-\iu \delta M_D}^{\lfloor t / \delta \rfloor} \psi_0\) in order to obtain an approximation of 
\begin{equation}
    e^{-\iu T H_D} \psi_0 = e^{-\iu (T-\lfloor \nicefrac{T}{\delta} \rfloor \delta) H_D} \underbrace{e^{-\iu \delta H_D} \dots e^{-\iu \delta H_D}}_{\lfloor \nicefrac{T}{\delta} \rfloor \text{ times}} \psi_0
    .
\end{equation}
With this approximation for the time-evolution operator at hand, the dynamics of expectation values \(\langle \nn \rangle\) can be evaluated by calculating matrix elements of \(\one\otimes\nn\) in the Krylov basis of each step.

\begin{table}[ht]
    \caption{A detailed time-table for the necessary implementations according to the project description in \cref{ch:project-description}.}
    \label{tab:roadmap}
    \centering
    \begin{tabular*}{\textwidth}{@{}l@{\extracolsep{\fill}}l@{}}
        \toprule
        Goal & To be completed \\
        \midrule
        Generic Lanczos algorithm & done \& tested  \\
        Projection \(\HH\to\mathcal{K}^{k}_H(\psi_0)\) and embedding \(\mathcal{K}^{k}_H(\psi_0) \hookrightarrow \HH\) & \carefull{10.12.2024}\\
        Time evolution by repeated Lanczos and \texttt{scipy.linalg.expm} & done \\
        Evaluation of expectation values during the evolution & \carefull{10.12.2024} \\
        % Spin and boson operators as sparse matrices & 17.12.2024 \\
        % Tensor/ Kronecker product of sparse matrices & 17.12.2024 \\
        Dicke Hamiltonian as sparse matrix in Dicke-Fock basis & 17.12.2024 \\
        Search for suitable \(\delta,\, K,\, n_{\mathrm{max}}\) & 20.12.2024 \\
        % \midrule
        Application to \(\langle \nn \rangle (t)\) & 10.01.2025 \\
        Dependence on \(N\) & 10.01.2025 \\
        (Dependence on \(\lambda\)) & (15.01.2025) \\
        Visualization and fitting & 15.01.2025 \\
        All results collected / Fix code on GitHub (release) & 15.01.2025 \\
        \bottomrule
    \end{tabular*}
\end{table}

Here, the expectation is that there is some saturation in \(\langle \nn \rangle\). 
If this is the case, the dependence of the saturation value on the number of spins can be analysed and compared for different initial states. 
Also, if time allows, the dependence of this behaviour on the coupling strength \(\lambda\) can be examined in view of the phase transition found by \textcite{heppSuperradiantPhaseTransition1973}.
Before the investigation of these questions, a search for a good choice of technical parameters is planned, in order to obtain good computational efficiency.
The parameters relevant to that are the duration \(\delta\), the number of Lanczos iterations \(K\) and the cut-off \(n_{\mathrm{max}}\) in the bosonic Hilbert space.
A detailed roadmap for the implementation and for when results are expected can be found in \cref{tab:roadmap}.
The code for the implementation is available via a private GitHub repository upon request \cite{richterImplementationsSimulationDicke}.

\pagebreak
\appendix

% \section{Roadmap for implementation and results}

\section*{Appendix}
\label{ch:proofs}
\begin{proof}[Proof of \cref{thm:lanczos-ONB}]
    We proof \cref{eq:lanczos-basis}, orthogonality \(\innerp{v_i}{v_j} = \delta_{i,j}, \forall i,j \leq n\), and \(\innerp{v_i}{H v_j} = \delta_{j, i-1} b_i + \delta_{i,j} a_i, \forall i,j \leq n\) by induction in \(n\).
    Consider the case \(n=0\).
    Then by \cref{eq:lanczos-basis-def}
    \begin{align}
        \label{eq:lanczos-proof-1}
        b_1 v_1 &= H v_0 - \innerp{v_0}{H v_0}v_0 = H v_0 - a_0 v_0 - b_0 v_{-1}
    \shortintertext{and}
        \innerp{v_0}{v_1} &= \frac{1}{b_1} \of*{ \innerp{v_0}{H v_0} - \innerp{v_0}{H v_0} \innerp{v_0}{v_0} } = 0
        \\
        \innerp{v_i}{v_i} &= \norm{v_i} = \norm*{\frac{\tilde v_i}{b_i}} = \frac{1}{\norm{\tilde v_i}}\norm{\tilde v_i} = 1, \quad i = 1,0
        \\
        \label{eq:lanczos-proof-2}
        \innerp{v_0}{H v_1} &= \innerp{H v_0}{v_1} = \innerp{b_1 v_1}{v_1} + \innerp{a_0 v_0}{v_1} = b_1,
    \end{align}
    where for \cref{eq:lanczos-proof-2} we have used that \(H\) is hermitian and by \cref{eq:lanczos-proof-1} \(Hv_0 = b_1 v_1 + a_0 v_0\).

    Now assume that for some \(n\in \N\) we have
    \begin{align}
        \label{eq:lanczos-proof-3}
        b_{i} v_{i} &= H v_{i-1} - a_{i-1} v_{i-1} - b_{i-1} v_{i-2}, \quad \forall i\leq n
        \\
        \label{eq:lanczos-proof-4}
        \innerp{v_i}{v_j} &= \delta_{i,j}, \quad \forall i,j \leq n-1
        \\
        \label{eq:lanczos-proof-5}
        \innerp{v_i}{H v_j} &= \delta_{j,i-1}b_i + \delta_{i,j} a_i, \quad \forall i,j \leq n-1
        .
    \end{align}
    Then by \cref{eq:lanczos-proof-5},
    \begin{align}
        b_{n+1}v_{n+1} = \tilde v_{n+1} 
        &= H v_{n} - \sum_{i=0}^{n} \innerp{v_i}{H v_{n}} v_i
        \\
        &= Hv_{n} - \sum_{i=0}^{n} \of{ \delta_{i,n-1} b_{n} v_i + \delta_{n,i}a_n v_i}
        \\
        &= Hv_{n} -a_n v_n -b_n v_{n-1}
        .
    \end{align}
    Furthermore, for \(j\leq n\) and with \cref{eq:lanczos-proof-3,eq:lanczos-proof-5}
    \begin{align}
        \innerp{\tilde v_{n+1}}{v_j} 
        &= \innerp{H v_n}{v_j} - a_n \innerp{v_n}{v_m} - b_n \innerp{v_{n-1}}{v_j} 
        \\
        &= \delta_{j,n-1}b_n + \delta_{n,j} a_n - a_n \delta_{n,j} - b_n \delta_{j, n-1}
        \\
        &= 0 
    \shortintertext{and}
    \innerp{v_{n+1}}{v_{n+1}} &= \frac{1}{b^2_{n=1}} \norm{\tilde v_{n+1}}^2 = 1
    .
    \end{align}
    Finally, for \(j\leq n+1\) we get
    \begin{align}
        \innerp{v_{n+1}}{ H v_j}
        &= \innerp{v_{n+1}}{v_{j+1}} b_{n+1} + a_n\innerp{v_{n+1}}{v_j} + b_j \underbrace{\innerp{v_{n+1}}{v_{j-1}}}_{= \delta_{n+1,j-1} = 0}
        \\
        &= \delta_{j, n+1 -1} b_{n+1} + \delta_{n+1,j} a_{n+1}
        ,
    \end{align}
    which concludes the induction.

    As \(\psi, H\psi, H^2\psi, \dots , H^K\psi\) are linearly independent, \(\Set{v_i}\) is a generating set for \(\mathcal{K}_H^{(K)}(v)\) by construction.
    \Cref{eq:lanczos-proof-5} for arbitrary \(n\) implies the tri-diagonal form \cref{eq:lanczos-tri-diagonal}.
    %  per
    % \begin{equation}
    %     (\innerp{v_i}{H v_j})_{i,j} = \innerp{v_i}{H v_j} = a_n \innerp{v_i}{v_j} + b_n \innerp{v_i}{v_{j-1}} + b_{j+1} \innerp{v_i}{v_{j+1}}
    % .
    % \end{equation}
\end{proof}


